<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>NTGD Monitor Dashboard</title>

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
      background: #ffffff; color: #2c3e50; line-height: 1.6; font-size: 16px;
    }
    .container { max-width: 1200px; margin: 0 auto; background: #fff; }

    .header { padding: 60px 40px 40px; text-align: center; border-bottom: 1px solid #e8e8e8; }
    .header h1 { font-size: 2.8em; font-weight: 300; margin-bottom: 16px; letter-spacing: -1px; }
    .header p { font-size: 1.1em; color: #7f8c8d; max-width: 600px; margin: 0 auto; }

    .controls {
      padding: 30px 40px; background: #fafafa; border-bottom: 1px solid #e8e8e8;
      display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 20px;
    }
    .control-group { display: flex; align-items: center; gap: 16px; }
    .control-group label { font-size: 14px; color: #7f8c8d; font-weight: 500; }
    .interval-input { width: 70px; padding: 8px 12px; border: 1px solid #d5d5d5; border-radius: 4px; text-align: center; font-size: 14px; }
    .interval-input:focus { outline: none; border-color: #2c3e50; }

    .btn {
      padding: 12px 24px; border: 1px solid #d5d5d5; border-radius: 4px; cursor: pointer;
      font-size: 14px; font-weight: 500; transition: all .2s ease; background: #fff; color: #2c3e50; text-decoration: none; display: inline-block; text-align: center;
    }
    .btn:hover:not(:disabled) { border-color: #2c3e50; color: #2c3e50; }
    .btn:disabled { opacity: .5; cursor: not-allowed; }
    .btn-primary { background: #2c3e50; border-color: #2c3e50; color: #fff; }
    .btn-primary:hover:not(:disabled) { background: #34495e; border-color: #34495e; }
    .btn-success { background: #27ae60; border-color: #27ae60; color: #fff; }
    .btn-success:hover:not(:disabled) { background: #229954; border-color: #229954; }
    .btn-danger { background: #e74c3c; border-color: #e74c3c; color: #fff; }
    .btn-danger:hover:not(:disabled) { background: #c0392b; border-color: #c0392b; }
    .btn-small { padding: 8px 16px; font-size: 12px; font-weight: 500; }

    .status { display: flex; align-items: center; gap: 8px; font-size: 13px; color: #7f8c8d; }
    .status-indicator { width: 8px; height: 8px; border-radius: 50%; background: #e74c3c; }
    .status-indicator.active { background: #27ae60; animation: pulse 2s infinite; }
    @keyframes pulse { 0% {opacity:1;} 50% {opacity:.5;} 100% {opacity:1;} }

    .summary { padding: 50px 40px; background: #fff; border-bottom: 1px solid #e8e8e8; }
    .summary-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 40px; text-align: center; }
    .summary-item { padding: 0; }
    .summary-value { font-size: 3em; font-weight: 300; margin-bottom: 8px; letter-spacing: -1px; }
    .summary-label { font-size: .9em; color: #7f8c8d; text-transform: uppercase; letter-spacing: 1px; }

    .organizations { padding: 50px 40px; }
    .org-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(380px, 1fr)); gap: 30px; }

    .org-card { 
      background: #fff; border: 1px solid #e8e8e8; padding: 40px 30px; position: relative;
      border-left: 4px solid transparent;
      transition: all .2s ease, border-left-color .3s ease;
    }
    .org-card:hover { border-color: #d5d5d5; box-shadow: 0 2px 8px rgba(0,0,0,.08); border-left-color: #2c3e50; }
    .org-card.has-error { border-left-color: #e74c3c; }
    .org-card.recently-updated {
      border-left-color: #27ae60;
      box-shadow: 0 2px 8px rgba(39, 174, 96, 0.15);
      animation: highlight-fade 4s ease-out;
    }
    @keyframes highlight-fade { 0% { box-shadow: 0 2px 8px rgba(39,174,96,.4); transform: scale(1.01); } 100% { box-shadow: 0 2px 8px rgba(39,174,96,.15); transform: scale(1); } }

    .org-name { font-size: 1.3em; margin-bottom: 30px; line-height: 1.3; display: flex; align-items: center; }
    .org-total { font-size: 3.5em; font-weight: 300; text-align: left; margin: 30px 0 40px; letter-spacing: -2px; }
    .org-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 0; margin: 30px 0; border-top: 1px solid #e8e8e8; padding-top: 30px; }
    .stat-item { text-align: left; }
    .stat-item:not(:last-child) { border-right: 1px solid #e8e8e8; padding-right: 20px; margin-right: 20px; }
    .stat-value { font-size: 1.8em; font-weight: 300; margin-bottom: 8px; letter-spacing: -.5px; }
    .stat-label { font-size: .8em; color: #7f8c8d; text-transform: uppercase; letter-spacing: 1px; }

    .freshness-indicator { display:inline-block; width:8px; height:8px; border-radius:50%; margin-left:8px; background:#bdc3c7; }
    .freshness-indicator.fresh { background:#27ae60; animation:pulse 2s infinite; }
    .freshness-indicator.stale { background:#f39c12; }
    .freshness-indicator.very-stale { background:#e74c3c; }

    .progress-container { position:relative; width:100%; height:20px; background:#ecf0f1; border-radius:10px; overflow:hidden; margin:8px 0; }
    .progress-bar { height:100%; background:linear-gradient(90deg,#27ae60 0%,#2ecc71 100%); border-radius:10px; transition:width .8s ease; position:relative; }
    .progress-text { position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); font-size:11px; font-weight:600; color:#2c3e50; text-shadow:0 1px 2px rgba(255,255,255,.8); z-index:1; }

    .stat-item.goal-progress { grid-column: span 3; border-right: none; padding-right: 0; margin-right: 0; }

    .org-actions { display:flex; justify-content:space-between; align-items:center; margin-top:40px; padding-top:30px; border-top:1px solid #e8e8e8; }
    .last-updated { font-size:.8em; color:#7f8c8d; }

    .error { color:#e74c3c; background:#fdf2f2; padding:15px; border:1px solid #fecaca; margin:0 0 20px; font-size:.9em; display:flex; justify-content:space-between; align-items:center; }

    .loading { text-align:center; padding:80px 40px; color:#7f8c8d; }
    .spinner { border:2px solid #f0f0f0; border-top:2px solid #7f8c8d; border-radius:50%; width:24px; height:24px; animation:spin 1s linear infinite; margin:0 auto 20px; }
    @keyframes spin { 0% {transform:rotate(0)} 100% {transform:rotate(360deg)} }

    .toast { position:fixed; top:30px; right:30px; padding:16px 24px; border-radius:4px; color:#fff; font-size:14px; font-weight:500; z-index:1000; transform:translateX(400px); transition:transform .3s ease; box-shadow:0 4px 12px rgba(0,0,0,.1); }
    .toast.show { transform:translateX(0); }
    .toast.success { background:#27ae60; }
    .toast.error { background:#e74c3c; }

    @media (max-width: 768px) {
      .header { padding: 40px 20px 30px; }
      .header h1 { font-size: 2.2em; }
      .controls { padding: 20px; flex-direction: column; align-items: stretch; gap: 15px; }
      .summary { padding: 30px 20px; }
      .summary-grid { grid-template-columns: repeat(2, 1fr); gap: 30px; }
      .summary-value { font-size: 2.5em; }
      .organizations { padding: 30px 20px; }
      .org-grid { grid-template-columns: 1fr; gap: 20px; }
      .org-card { padding: 30px 20px; }
      .org-total { font-size: 3em; }
      .org-stats { grid-template-columns: 1fr; gap: 20px; }
      .stat-item:not(:last-child) { border-right: none; border-bottom: 1px solid #e8e8e8; padding-right: 0; padding-bottom: 20px; margin-right: 0; margin-bottom: 20px; }
      .stat-item.goal-progress { grid-column: span 1; }
      .error { flex-direction: column; align-items: flex-start; gap: 10px; }
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <h1>NTGD Monitor Dashboard</h1>
      <p id="headerDescription">Loading your organizations…</p>
    </div>

    <div class="controls">
      <div class="control-group">
        <label for="refreshInterval">Refresh every:</label>
        <input type="number" id="refreshInterval" value="90" min="30" max="600" class="interval-input"/>
        <span>seconds</span>
      </div>

      <div class="control-group">
        <button class="btn btn-success" id="startBtn">Start Auto-Refresh</button>
        <button class="btn btn-danger" id="stopBtn" style="display:none;">Stop Auto-Refresh</button>
        <button class="btn btn-primary" id="refreshNowBtn">Refresh Now</button>
        <button class="btn btn-primary" id="exportBtn">Export Data</button>
      </div>

      <div class="status">
        <div class="status-indicator" id="statusIndicator"></div>
        <span id="statusText">Auto-refresh stopped</span>
        <span>•</span>
        <span id="lastUpdate">Never updated</span>
      </div>
    </div>

    <div class="summary">
      <div class="summary-grid">
        <div class="summary-item">
          <div class="summary-value" id="totalRaised">$0</div>
          <div class="summary-label">Total Raised</div>
        </div>
        <div class="summary-item">
          <div class="summary-value" id="totalDonors">0</div>
          <div class="summary-label">Total Donors</div>
        </div>
        <div class="summary-item">
          <div class="summary-value" id="avgGift">$0</div>
          <div class="summary-label">Average Gift</div>
        </div>
        <div class="summary-item">
          <div class="summary-value" id="orgCount">0</div>
          <div class="summary-label">Organizations</div>
        </div>
      </div>
    </div>

    <div class="organizations">
      <div id="organizationsContainer" aria-live="polite">
        <div class="loading">
          <div class="spinner"></div>
          <p>Loading your organizations…</p>
        </div>
      </div>
    </div>
  </div>

  <!-- bump ?v when you change app.js to bust caches -->
  <script src="/app.js?v=ly-3" defer></script>
</body>
</html>
